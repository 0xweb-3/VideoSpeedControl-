# 测试文件说明

本目录包含了视频播放控制器扩展的所有测试文件和测试场景。

## 📁 测试目录结构

```
tests/
├── manual/                    # 手动测试
│   └── test-page.html        # 完整功能测试页面
├── unit/                     # 单元测试
│   └── content-script.test.js # 内容脚本单元测试
├── integration/              # 集成测试
│   └── extension-integration.test.js # 扩展集成测试
└── README.md                # 本说明文件
```

## 🧪 测试类型说明

### 1. 手动测试 (Manual Testing)
**位置**: `manual/test-page.html`

**用途**: 完整的功能验证页面，包含：
- 基础视频控制测试
- 速度控制测试  
- 多视频测试
- 悬浮面板测试
- 设置测试
- 兼容性测试
- 文本输入干扰测试
- 性能稳定性测试

**使用方法**:
1. 在Chrome中加载扩展
2. 在浏览器中打开 `test-page.html`
3. 按照页面上的测试清单逐项验证

### 2. 单元测试 (Unit Testing)
**位置**: `unit/content-script.test.js`

**覆盖功能**:
- VideoController类初始化
- 视频管理功能
- 视频快进快退
- 播放速度控制
- 设置验证
- 键盘事件处理
- 性能测试

**运行方式**:
```bash
# 在支持Jest的环境中
npm test

# 或在浏览器控制台中执行
# 加载测试文件后运行相应测试函数
```

### 3. 集成测试 (Integration Testing)
**位置**: `integration/extension-integration.test.js`

**测试场景**:
- 设置同步功能
- 组件间消息传递
- 扩展生命周期
- 存储错误处理
- 标签页通信
- 实际使用场景
- 性能集成测试

## 🚀 如何运行测试

### 手动测试步骤
1. **准备环境**
   ```bash
   # 在Chrome中加载扩展
   # 1. 打开 chrome://extensions/
   # 2. 启用开发者模式
   # 3. 点击"加载已解压的扩展程序"
   # 4. 选择项目根目录
   ```

2. **运行测试页面**
   ```bash
   # 方法1: 直接打开文件
   open tests/manual/test-page.html
   
   # 方法2: 通过HTTP服务器
   python -m http.server 8000
   # 然后访问 http://localhost:8000/tests/manual/test-page.html
   ```

3. **执行测试清单**
   - 按照测试页面上的步骤执行
   - 勾选每个完成的测试项
   - 记录任何发现的问题

### 自动化测试运行

#### 单元测试
```bash
# 如果安装了Jest
npm install jest -g
npm test

# 或手动在浏览器中运行
# 1. 打开Chrome开发者工具
# 2. 在Console中加载测试文件
# 3. 运行测试函数
```

#### 集成测试
```bash
# 需要在Chrome扩展环境中运行
# 1. 加载扩展到Chrome
# 2. 打开背景页面的开发者工具
# 3. 运行集成测试脚本
```

## 📋 测试清单

### ✅ 基础功能测试
- [ ] 扩展正确安装和加载
- [ ] 视频自动检测功能
- [ ] 键盘快捷键响应
- [ ] 悬浮面板显示
- [ ] 设置界面正常

### ⌨️ 键盘快捷键测试
- [ ] Z键后退功能
- [ ] X键后退功能
- [ ] C键快进功能
- [ ] V键快进功能
- [ ] 文本框中不触发快捷键

### 🎛️ 控制面板测试
- [ ] 面板自动显示/隐藏
- [ ] 拖拽移动功能
- [ ] 速度按钮响应
- [ ] 关闭按钮功能

### ⚙️ 设置功能测试
- [ ] 时间间隔自定义
- [ ] 设置保存和加载
- [ ] 语言切换功能
- [ ] 重置为默认设置

### 🌐 兼容性测试
- [ ] YouTube正常工作
- [ ] Bilibili正常工作
- [ ] 本地视频文件
- [ ] 多个视频同时控制
- [ ] 不同浏览器版本

### 🚀 性能测试
- [ ] 内存使用正常
- [ ] CPU占用较低
- [ ] 响应速度快
- [ ] 无内存泄漏

## 🐛 常见问题排查

### 问题1: 快捷键不响应
**可能原因**:
- 焦点在文本输入框中
- 页面视频未正确加载
- 扩展权限不足

**解决方案**:
- 点击视频区域外的页面空白处
- 刷新页面重新加载视频
- 检查扩展权限设置

### 问题2: 悬浮面板不显示
**可能原因**:
- 面板被关闭
- 视频未检测到
- CSS样式冲突

**解决方案**:
- 检查设置中的"显示控制面板"选项
- 确认页面有有效的视频元素
- 查看浏览器控制台错误信息

### 问题3: 设置不保存
**可能原因**:
- 存储权限问题
- Chrome同步问题
- 扩展更新导致

**解决方案**:
- 重新安装扩展
- 检查Chrome同步设置
- 清除扩展数据后重新配置

## 📊 测试报告模板

```markdown
## 测试报告

### 测试环境
- Chrome版本: 
- 操作系统: 
- 扩展版本: 
- 测试日期: 

### 测试结果
#### 通过的测试 ✅
- 基础功能测试
- 键盘快捷键测试
- ...

#### 失败的测试 ❌
- [描述失败的测试]
- 错误信息: 
- 复现步骤: 

#### 性能指标 📊
- 内存使用: 
- CPU占用: 
- 响应时间: 

### 建议改进
- [列出发现的问题和建议]
```

## 🎯 测试最佳实践

1. **测试前准备**
   - 清理浏览器缓存
   - 关闭其他扩展避免冲突
   - 使用干净的Chrome配置文件

2. **系统化测试**
   - 按照清单逐项测试
   - 记录每个测试结果
   - 保存错误截图和日志

3. **多环境测试**
   - 不同操作系统
   - 不同Chrome版本
   - 不同网站环境

4. **回归测试**
   - 修复问题后重新测试
   - 确保新功能不影响现有功能
   - 定期运行完整测试套件

---

**测试是确保扩展质量的关键步骤，请认真执行每个测试项目！** 🧪✨